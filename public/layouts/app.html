<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TF-FARMACIA</title>

  <base href="/" />

  <link rel="stylesheet" href="/tf_farmacia_frontend/public/assets/app.css" />

  <!-- estilos mínimos: usuario, dropdown y loader -->
  <style>
    /* toggle de usuario: sin fondo, texto blanco */
    .user-menu{position:relative}
    .user-toggle{
      display:inline-flex; align-items:center; gap:.5rem;
      color:#fff; font-weight:600; padding:.375rem .5rem; border-radius:.5rem;
      background:transparent; border:none; cursor:pointer; line-height:1;
      -webkit-appearance:none; -moz-appearance:none; appearance:none;
    }
    .user-toggle:hover{ background:rgba(255,255,255,.12) }
    .user-caret{
      width:.5rem; height:.5rem; border:2px solid #fff; border-left:0; border-top:0;
      transform:rotate(45deg); transition:transform .15s ease;
      margin-top:-2px;
    }
    .user-menu.open .user-caret{ transform:rotate(-135deg) }

    /* dropdown */
    .menu-panel{
      position:absolute; right:0; top:calc(100% + .5rem);
      min-width:11rem; background:#fff; border:1px solid #e5e7eb;
      border-radius:.5rem; box-shadow:0 10px 20px rgba(2,6,23,.12);
      padding:.25rem 0; z-index:40; display:none;
    }
    .user-menu.open .menu-panel{ display:block }
    .menu-item{
      display:block; width:100%; padding:.5rem .75rem; text-align:left;
      background:#fff; color:#374151; border:0; cursor:pointer;
      font-size:.875rem; line-height:1.2;
    }
    .menu-item:hover{ background:#f9fafb }

    /* overlay de logout */
    #logout-overlay{display:none; align-items:center; justify-content:center}
    #logout-overlay.show{display:flex}
    .spinner{
      width:28px; height:28px; border-radius:9999px;
      border:3px solid #e5e7eb; border-top-color:#0d6efd; animation:spin 1s linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body class="bg-gray-50 text-gray-900 antialiased">
  <div class="min-h-dvh">
    <header class="bg-brand header-shadow">
      <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between">
        <div class="brand-banner" role="img" aria-label="TF-FARMACIA"></div>

        <!-- menú de usuario -->
        <div class="user-menu" id="user-menu-root">
          <button id="user-menu-button" class="user-toggle" aria-haspopup="menu" aria-expanded="false">
            <span>Anthony</span>
            <i class="user-caret" aria-hidden="true"></i>
          </button>

          <div id="user-menu" class="menu-panel" role="menu" aria-labelledby="user-menu-button">
            <button id="logout-btn" class="menu-item" role="menuitem">Cerrar sesión</button>
          </div>
        </div>
      </div>
    </header>

    <main id="page-content" class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 py-8"></main>

    <footer class="mt-10 border-t border-gray-200 bg-white">
      <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 py-4 text-sm text-gray-500">
        © <span id="y"></span> TF-FARMACIA
      </div>
    </footer>
  </div>

  <!-- overlay de cierre de sesión -->
  <div id="logout-overlay" class="fixed inset-0 bg-black/40 z-50" aria-hidden="true">
    <div class="bg-white rounded-xl shadow-lg px-6 py-5 flex items-center gap-3">
      <div class="spinner"></div>
      <div class="text-sm font-medium text-gray-700">Cerrando sesión…</div>
    </div>
  </div>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    (function () {
      const root = document.getElementById('user-menu-root');
      const btn = document.getElementById('user-menu-button');
      const menu = document.getElementById('user-menu');
      const logout = document.getElementById('logout-btn');
      const overlay = document.getElementById('logout-overlay');

      function openMenu(){ root.classList.add('open'); btn.setAttribute('aria-expanded','true'); }
      function closeMenu(){ root.classList.remove('open'); btn.setAttribute('aria-expanded','false'); }
      function toggleMenu(){ root.classList.contains('open') ? closeMenu() : openMenu(); }

      btn.addEventListener('click', (e)=>{ e.stopPropagation(); toggleMenu(); });
      document.addEventListener('click', (e)=>{ if(!root.contains(e.target)) closeMenu(); });
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeMenu(); });

      logout.addEventListener('click', async (e)=>{
        e.preventDefault(); closeMenu();
        overlay.classList.add('show');
        await new Promise(r=>setTimeout(r,3000));
        window.location.href = '/tf_farmacia_frontend/index.html';
      });
    })();
  </script>

  <script type="module" src="/tf_farmacia_frontend/src/index.js"></script>
</body>
</html>
